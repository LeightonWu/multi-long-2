---
title: "Income and Health Disparities in Aging"
date: "2024-11-05"
author: "Student ID: 11484265"
output:
  pdf_document: default
  html_document: default
  output: pdf_document
  fontsize: 12pt
  urlcolor: "blue"
  geometry: margin=2in
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo=FALSE, 
                      eval=TRUE, message=FALSE, 
                      warning=FALSE, fig.align='center',
                      fig.dim=c(5,3))
                      
# copy from scripts
library(rmarkdown)
library(tidyverse)
library(tinytex)
library(checkpoint)
library(knitr)
library(kableExtra)
library(manipulateWidget)
library(lavaan)

```


```{r clean, cache=TRUE}
source(file="clean.R")
```

```{r model, cache=TRUE}
source(file="models.R")
```

```{r vis}
source(file="vis.R")
```


```{=latex}
\setcounter{tocdepth}{3}
\tableofcontents
```

\newpage 

\pagenumbering{arabic}



# Introduction

How does income influence health outcomes across four waves (waves 7 to 10) in the aging population? Examining the link between income and health over multiple waves is essential to understanding the cyclical or cumulative effects of socioeconomic factors on health as people age. Income levels not only affect access to healthcare, nutritious food, and stable housing, but they also impact stress levels and overall mental well-being—all crucial factors for healthy aging. Tracking this relationship longitudinally helps clarify whether income shifts (such as retirement or financial strain) directly influence health, or if deteriorating health constrains income potential (e.g., due to medical costs or decreased work capability).

To address these research questions, cross-lagged models will be used, which are well-suited for examining the reciprocal effects between income and health over time. 
Cross-sectional data only provide a snapshot, making it hard to determine cause-and-effect relationships. Longitudinal models like CLPM allow you to establish the temporal ordering of income and health changes. This approach helps in suggesting causal inferences, even though cross-lagged models don’t establish causation outright.  By analyzing waves over time, longitudinal methods capture these natural aging dynamics, providing a more realistic model of how income and health interact in real-life aging populations.


# Data and methods (30%):

The English Longitudinal Study of Ageing (ELSA) is a comprehensive dataset that tracks the aging process among individuals aged 50 and above in England. ELSA collects data across multiple domains, including socioeconomic factors, health, and psychological well-being, with repeated measures over time. For this analysis, I focus on waves 7 to 10, allowing a four-wave longitudinal perspective on changes in health and income.

## Variables

* Income: The equivalised total income at the benefit unit level, adjusted for unit size. Total income here includes employment income, self-employment income, state benefits, state pension, private pension, asset income, and other sources. Each member of a benefit unit is assigned the unit's total income, providing a measure of financial resources adjusted to account for household composition. Records with missing income data are removed.

<!-- * Wealth: Net total wealth at the benefit unit level, calculated as the combined value of savings, investments, physical assets, and housing wealth, minus financial and mortgage debt. -->

* Self-Reported Health: Health is captured through self-reported health status, often regarded as a reliable predictor of mortality, morbidity, and overall well-being in longitudinal studies. Records with missing health data are removed.

* IDs: Individual and household IDs ensure that data points are accurately linked across waves, facilitating longitudinal analysis.

## Descriptive statistics 

```{r descriptive}

tabIncome
tabHSE
tabHRS

```



## Explain what models (and their sequence) you are going to use 
A series of cross-lagged panel models will be used, gradually incorporating constraints and random intercepts to refine the model.

1. Unconstrained Cross-Lagged Model: A basic cross-lagged model, estimating paths without any constraints across the waves. This model allows for an initial understanding of the dynamic relationships between income and health over time, with all parameters freely estimated for each wave.

2. Equality-Constrained Models: Equality constraints will be added one wave at a time. At each step, the new model will be compared to the previous best model using a Chi-Square difference test (ANOVA) to see if adding the constraint significantly betters the fit. This gradual process helps identify if certain effects are stable across time.

3. Random Intercept Cross-Lagged Model: Random intercepts for both income and health will be included. This step accounts for individual differences that might consistently affect these variables across waves (e.g., baseline levels of income or health that vary between individuals). ANOVA will be used to test if the inclusion of random intercepts significantly improves the model fit.



# Analysis
•	Present the different models and interpret them 
## Model 1 (Base)

```{r M1}
cat(model_1)
sumM1
```

The model indicates a significant positive effect of previous income on subsequent income across waves, though the effect size decreases over time (0.567 for Wave 8, 0.530 for Wave 9, and 0.283 for Wave 10). Health also has a significant but small negative effect on income in all waves, suggesting that poorer health is associated with a slight reduction in future income.

Similarly, health shows strong stability over time, with previous health significantly predicting future health (coefficients around 0.65 across waves). Income has a modest negative effect on health in each wave, although the impact is smaller than the stability of health over time.

The covariances between income and health are generally negative but small, and only significant in Waves 7, 8, and 10. This suggests a minor inverse relationship between income and health at each wave level, but it is not consistently strong across all waves.


## Model 2-4

```{r M2}
cat(model_2)
sumM2
anvM12
```

Equality constraints were applied to the cross-lagged paths between income and health, specifically for the effect of each variable on the other (parameter "a" was constrained to be equal across both directions). The results show that income and health continue to significantly predict each other over time, with both cross-lagged effects remaining negative.

The significant chi-squared difference between the initial model (fit_1) and the constrained model (fit_2) indicates that adding this constraint has a statistically significant impact on model fit. The constrained model, however, has a slightly higher AIC and BIC, suggesting a potential trade-off between model parsimony and fit quality. Additionally, the RMSEA remains low, suggesting the model still has a good fit overall despite the constraint.

The model with additional constraints on the cross-lagged paths for wave 9 and 10 did not yield significant chi-squared results, indicating that the fit did not improve compared to the previous model. The model may be too restrictive, limiting the model's ability to accurately represent the relationships.

## Model 5-7

Equality constraint were placed on each wave's autoregressive path and compared to the prevoius. In the end all were significant.

```{r M5}
cat(model_7)
anvM25
anvM56
anvM67

sumM7
```


Strong regression coefficients for both income and health across the waves can be observed. For instance, in W8, income shows a strong positive relationship with Income_W7 (b = 0.620), indicating that higher income in the previous wave strongly predicts income in W8. Conversely, there is a negative relationship with Health_HRS_W7 (a = -0.059), suggesting that better health in W7 is associated with lower income in W8. Similar patterns are evident in W9 and W10, where income in each wave consistently predicts income in subsequent waves. Health measures also show significant positive relationships with their previous wave, though some relationships, like Health_HRS_W8 on Income_W9, are non-significant.

The covariances highlight significant negative correlations between income and health at W7, W8, and W10, with the strongest correlation observed between Income_W7 and Health_HRS_W7 (Estimate = -0.174). This finding indicates that individuals with higher income tend to report poorer health and vice versa, a key aspect of your analysis.

In terms of intercepts and variances, all variables show significant positive variances across waves, indicating variability in income and health measures among the sample. The intercept for Health_HRS_W7 is negative, suggesting that the average health score at W7 is below zero, while subsequent health variables have positive intercepts, reflecting improved health measures over time.


## Model 8

```{r M7}
cat(model_8)
sumM8
anvM78
```

The intercepts in the cross-lagged model provide important insights into the overall trends of income and health over time. The negative intercepts for Income_W8, Income_W9, and Income_W10 suggest that, on average, individuals' incomes at these waves are below zero, indicating economic challenges faced by the population. This persistent low income level may reflect systemic issues that affect financial stability, such as job insecurity or insufficient social support.

In contrast, Health_HRS_W10 shows a positive intercept, implying that health perceptions or outcomes have improved on average over the study period. This suggests a potential increase in the overall health status of individuals despite the declining income levels. The discrepancy between income and health trends may indicate that improvements in health could be driven by factors other than income, such as enhanced access to healthcare, public health initiatives, or changes in social determinants of health.


##	Model Assumptions

### Sample Size

Klein et al recommend a ratio of 20 cases per variable measured. This is met at a total of 78443 for the 33 model parameters, averaging 2377 observations per parameter.

### Temporal Order

The flow of influence in the model is unidirectional due to the nature of panel studies conducted in waves; events that occur later in time cannot influence those that have already happened.

### Variable Distributions

```{r skew}

graphHealth
graphIncome1
graphIncome2

```

The distribution of health is fairly even. While there are extremely high outliers for income, the main distribution (zoomed-in) is not highly skewed.

<!-- * (Pedhazur, 1997) residuals are not intercorrelated -->

* usual assumptions that one commonly finds in regression






# Conclusions

This study aimed to explore the relationship between income and health over time, specifically examining how each influences the other across waves of data collection. a cross-lagged panel model was constructed, allowing us to test the bidirectional influences of income and health across multiple waves. The model included lagged paths that assessed the predictive power of income on health outcomes over time and vice versa, while controlling for autoregressive effects within each variable. The results indicated that while income at an earlier wave significantly predicted subsequent health status, the reverse effect of health on income showed mixed significance across waves, suggesting a stronger influence of income on health than health on income. Longitudinal data analysis was essential to answering the research question because it allowed us to observe changes and relationships over time rather than just at a single point. 
 
The study faced several limitations affecting the reliability and generalizability of its findings. Self-reported health are prone to measurement errors; objective health data could improve accuracy. Attrition bias is another concern, as participant dropout over time may introduce bias if remaining participants differ significantly, especially regarding health or income levels. While autoregressive effects control for some stability, unobserved confounders, like lifestyle or environment, may still impact results. Additionally, the study’s limited timeframe, covering only waves 7 to 10, may miss long-term income-health dynamics, and the UK-based sample restricts generalizability to other contexts. Lastly, cross-lagged models suggest causal direction but do not confirm causation, so findings should be interpreted as associations. 






\newpage

# Appendix A - R code: data cleaning

```{r code1, comment = ""}
source("clean.R", echo = T, print.eval = F,
       max.deparse.length=Inf, keep.source=T)
```

\newpage 

# Appendix B - R code: modelling

```{r code2, comment = ""}
source("models.R", echo = T, print.eval = F,
       max.deparse.length=Inf, keep.source=T)
```

\newpage 

# Appendix C - R code: visualization

```{r code3, comment = ""}
source("vis.R", echo = T, print.eval = F,
       max.deparse.length=Inf, keep.source=T)
```
\newpage

# Appendix D - R code: rmarkdown chunks

```{r get-labels, echo=FALSE, eval=TRUE}
labs = knitr::all_labels()
labs = setdiff(labs, c("setup", "get-labels"))
```

```{r all-code, ref.label=labs, echo=TRUE, eval=FALSE}
```






